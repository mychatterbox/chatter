---
import { getCollection } from "astro:content";
import type { CollectionEntry } from "astro:content";

export async function getStaticPaths() {
    const blogPosts = await getCollection("blog");

    let draftPosts: CollectionEntry<"draft">[] = [];
    if (import.meta.env.DEV) {
        try {
            draftPosts = await getCollection("draft");
        } catch {
            // ignore
        }
    }

    const allPosts = [...blogPosts, ...draftPosts];
    const kinds = new Set(allPosts.map((entry) => entry.data.kind));

    return Array.from(kinds).map((kind) => ({ params: { kind } }));
}

const { kind } = Astro.params;
return Astro.redirect(`/kind/${kind}/1`);
---
